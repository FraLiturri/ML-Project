TO DO: 
Change some var names (single_output) to a clearer one;  