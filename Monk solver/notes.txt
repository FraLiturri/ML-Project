TO DO: 
substitute VectorXd with Vector<double, N> where the size of the vector is well-known; 